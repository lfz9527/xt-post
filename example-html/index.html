<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>xt-post CDN Test</title>
  </head>
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
    }
  </style>
  <body>
    <h1>xt-post CDN 测试</h1>

    <!-- 本地“模拟 CDN” -->

    <button id="callParent">调用父方法</button>
    <button id="sendEventToParent">发送事件给父方法</button>

    parentTitle:
    <p id="innerText"></p>
  </body>

  <script src="../lib/xt-post.umd.min.js"></script>
  <script>
    const innerText = document.getElementById("innerText");
    const xtPost = new XtPost({
      debug: true,
      id: "children-1",
      iframeId: "iframe-1",
    });

    document
      .getElementById("callParent")
      .addEventListener("click", async () => {
        const parentTitle = await xtPost.call("getParentTitle");
        innerText.innerText = parentTitle;
      });

    document
      .getElementById("sendEventToParent")
      .addEventListener("click", async () => {
        xtPost.emit("eventFromChild", "child-1 发送的事件");
      });
    xtPost.on("eventFromParent", (data) => {
      console.log("parent-1 子元素发送的事件:", data);
      innerText.innerText = JSON.stringify(data);
    });
    xtPost.expose("getChildren", () => {
      return "children-1 title";
    });
  </script>
</html>
